(function(o,m){var j;function h(){j=this;this.way=[];this.data={};this.opt={domain:".sogou.com",etagUrl:"asset/etag.php",silverlightSrc:"asset/1.xap"};this.weights={flash:20,indexDB:16,localStorage:15,userData:14,etag:13,normal:1,wName:5,Silverlight:2};this.debug={data:{s:"0",u:"0",us:"0",y:"0"},send:function(){var s="http://dsp.brand.sogou.com/cookie_plant_status?";var u="";for(var r in this.data){u+=r+"="+this.data[r]+"&"}u+="_r="+Math.random();var t=new Image();t.src=s+u},setStatus:function(s,t){this.data.us=t;var r=0;switch(s){case"flash":r=1;break;case"indexDB":r=2;break;case"localStorage":r=3;break;case"userData":r=4;break;case"etag":r=5;break;case"wName":r=6;break;case"normal":r=7;break;default:r=8;break}this.data.s=r}};this.delay()}h.prototype={init:function(){var r=this;this.creat();setTimeout(function(){r.resetW();r.business()},50)},delay:function(){var t=this;var s=200;function r(){setTimeout(function(){t.init();t=null;s=null},s)}if(o.addEventListener){o.addEventListener("load",r)}else{o.attachEvent("onload",r)}},business:function(){var t=this;var s=["SUID","YYID"];t.debug.data.u=q("SUID");t.debug.data.y=q("YYID");for(var r=0;r<s.length;r++){t.getCookie(s[r])}setTimeout(function(){for(var u=0;u<s.length;u++){var w=s[u];t.getDate(w);var v=t.data[w];t.setCookie(w,v)}if(Math.random()<0.2){t.debug.send()}t=null},500)},getCookie:function(t){if(!t){return}var r=j.getWayLength();var u=this;for(var s=0;s<r;s++){(function(v){if(u.way[v].getCookie){u.way[v].getCookie(t)}})(s)}u=null},setCookie:function(t,u){if(typeof t=="undefined"||typeof u=="undefined"){return}var r=j.getWayLength();for(var s=0;s<r;s++){(function(v){j.way[v].setCookie(t,u)})(s)}this.data[t]=u},recoverCookie:function(t){var r=j.getWayLength();var u=this;for(var s=0;s<r;s++){if(u.way[s].data[t]){u.data[t]=u.way[s].data[t];break}}u.setCookie(t,u.data[t]);u=null},getDate:function(t){var s,r=this.getWayLength();for(s=0;s<r;s++){if(this.way[s].data[t]){this.data[t]=this.way[s].data[t];this.debug.setStatus(this.way[s].name,this.way[s].data[t]);break}}},getWayLength:function(){return this.way.length},addWay:function(t,s){var r=c(t,s);this.way.push(r)},sortWay:function(){this.way.sort(function(s,r){s.weights=s.weights||0;r.weights=r.weights||0;return r.weights-s.weights})},creat:function(){var v=new l();this.addWay(v,{name:"normal",domain:j.opt.domain});var u=new d();if(u.isSupport){this.addWay(u)}var t=new b();if(t&&t.support){this.addWay(t,{name:"flash",weights:16,data:{}})}var w=new f();if(w.name){this.addWay(w)}var r=new e();this.addWay(r);var s=new i();this.addWay(s);this.sortWay()},resetW:function(){for(var r=0;r<this.way.length;r++){var s=this.way[r];s.weights=this.weights[s.name]||s.weights||1}this.sortWay()}};function c(t,s){if(!s){return t||{}}for(var r in s){t[r]=s[r]}return t}function p(s,v){if(typeof v!=="string"){return}var u=s+"=",r=v.split(/[;&]/),t,w;for(t=0;t<r.length;t++){w=r[t];while(w.charAt(0)===" "){w=w.substring(1,w.length)}if(w.indexOf(u)===0){return w.substring(u.length,w.length)}}}function q(s){var r="";var t=new RegExp("(^| )"+s+"=([^;]*)(;|\x24)");var u=t.exec(m.cookie);if(u){r=u[2]}return r}function n(s,u,t){t=t||".sogou.com";var v=new Date();v.setTime(v.setFullYear(2050));var r=s+"="+u+"; path=/; expires="+v.toGMTString()+"; domain="+t;m.cookie=r}function a(t,v){v=v||".sogou.com";if(t){var w=new Date();var s=t+"=null; path=/; expires="+w.toGMTString()+"; domain="+v;m.cookie=s}else{var u=m.cookie.match(/[^ =;]+(?=\=)/g);for(var r=u.length;r>0;r--){m.cookie=u[r-1]+"=0;expires=; path=/"+new Date().toUTCString()+"; domain="+v}}}function k(t){var s=t.url;var v=t.success;var r=t.error;var u=null;if(window.XMLHttpRequest){u=new XMLHttpRequest()}else{u=new ActiveXObject("Microsoft.XMLHTTP")}u.open("GET",s,true);u.send();u.onreadystatechange=function(){if(u.readyState==4){if(u.status==200){v(u.responseText)}else{r(u.responseText)}}}}function l(){this.name="normal";this.weights=20;this.data={};this.domain=".sogou.com"}l.prototype={getCookie:function(r){this.data[r]=q(r)},setCookie:function(r,s){n(r,s,this.domain);this.data[r]=s},clear:function(r){a(r,this.domain);this.data[r]=null}};function d(){if(o.localStorage&&o.localStorage.getItem){this.isSupport=true;this.localStorage=o.localStorage}else{this.isSupport=false}this.name="localStorage";this.weights=15;this.data={}}d.prototype={getCookie:function(r){if(this.isSupport){this.data[r]=this.localStorage.getItem(r)}},setCookie:function(r,s){if(this.isSupport){this.localStorage.setItem(r,s);this.data[r]=s}},clear:function(r){if(this.isSupport){this.localStorage.removeItem(r);this.data[r]=null}}};function g(r){this.baseUrl=r;this.name="etag";this.weights=13;this.data={};this.addKey="etag"}g.prototype={getCookie:function(s){var u=s+this.addKey;var t=this;var r=t.baseUrl+"?name="+u;j.ready=false;k({url:r,success:function(v){t.data[s]=v;j.ready=true;t=null}})},setCookie:function(s,t){var v;if(t!==""){v=s+this.addKey}else{v=""}var u=this;var r=u.baseUrl+"?name="+v;n(v,t);k({url:r,success:function(w){u.data[s]=w;u=null}})},clear:function(r){this.setCookie(r,"null")}};function b(){this.name="flash";this.data={}}if(typeof o.SwfStore!="undefined"){b.prototype=new SwfStore({namespace:"sogou_cookie",isInit:false,swf_url:"http://images.sohu.com/cs/jsfile/js/co.swf",onready:function(){this.isInit=true}});b.prototype.support=true;b.prototype.getCookie=function(r){if(!this.config.isInit){return}var s=this.get(r);this.data[r]=s};b.prototype.setCookie=function(r,s){if(!this.config.isInit){return}this.set(r,s);this.data[r]=s}}function f(){function r(){if(o.indexedDB){return true}else{return false}}if(!r()){return false}this.name="indexDB";this.weights=10;this.data={}}f.prototype={getCookie:function(r){this.sg_cookie(r)},setCookie:function(r,s){this.sg_cookie(r,s);this.data[r]=s},clear:function(r){this.setCookie(r,"")},sg_cookie:function(s,u){var w=this;try{if(!("indexedDB" in o)){indexedDB=o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB;IDBTransaction=o.IDBTransaction||o.webkitIDBTransaction||o.msIDBTransaction;IDBKeyRange=o.IDBKeyRange||o.webkitIDBKeyRange||o.msIDBKeyRange}if(indexedDB){var r=1;var t=indexedDB.open("sogo_ad",r);t.onerror=function(x){};t.onupgradeneeded=function(z){var y=z.target.result;var x=y.createObjectStore("cookie",{keyPath:"name",unique:false})};if(u!==undefined){t.onsuccess=function(B){var x=B.target.result;if(x.objectStoreNames.contains("cookie")){var z=x.transaction(["cookie"],"readwrite");var A=z.objectStore("cookie");var y=A.put({name:s,value:u})}x.close()}}else{t.onsuccess=function(B){var x=B.target.result;if(!x.objectStoreNames.contains("cookie")){w.data[s]=""}else{var z=x.transaction(["cookie"]);var A=z.objectStore("cookie");var y=A.get(s);y.onsuccess=function(C){if(y.result===undefined){w.data[s]=""}else{w.data[s]=y.result.value}}}x.close()}}}}catch(v){}}};function e(){this.name="wName";this.weights=5;this.data={}}e.prototype={getCookie:function(r){if(!o.name){this.data[r]=""}else{this.data[r]=p(r,o.name)}},setCookie:function(u,v){if(o.name.indexOf(u)!=-1){var w=o.name;var t=w.split(u);var s=t[1].split("=");s.pop();var r=t[0]+u+"="+v+";"+s.join("=");o.name=r}else{o.name+=(u+"="+v+";")}},clear:function(r){this.setCookie(r,"")}};function i(){this.name="userData";this.weights=14;this.data={};this.doms=null;this.init()}i.prototype={init:function(){this.doms=m.createElement("div");this.doms.style.display="none";m.body.appendChild(this.doms)},getCookie:function(r){this.user_cookie(r)},setCookie:function(r,s){this.user_cookie(r,s)},clear:function(r){this.setCookie(r,"")},user_cookie:function(r,s){try{var u=this.doms;u.style.behavior="url(#default#userData)";if(s!==undefined){u.setAttribute(r,s);u.save(r);this.data[r]=s}else{u.load(r);this.data[r]=u.getAttribute(r);return u.getAttribute(r)}}catch(t){}}};window.SG_COOKIE=h;new h()})(window,document);